import{d as T,c as n,o as U,j as te,h as r,a as u,k as q,l as se,b as o,t as v,m as F,u as ae,r as L,p as ne,q as oe,x as b,F as B,g as D,w as le,v as re,f as V,y as ue,n as ce,z as ie,A as ve,i as de}from"./index-79660912.js";import{a as M,u as fe}from"./words-46377e1a.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const pe={class:"operate"},_e=T({__name:"operate",setup(h){const c=M(),w=n(()=>c.config),d=f=>f?"开":"关",l=async f=>{const a=!w.value[f];await c.update({id:f,value:a})},i=async()=>{(await c.get()).length||(await c.save({id:"voice",value:!1}),await c.save({id:"syllables",value:!0}),await c.save({id:"review",value:!1}),await c.save({id:"view",value:!1}))};return U(async()=>{await i()}),(f,a)=>{const $=te("router-link");return r(),u("div",pe,[q($,{tag:"a",to:{name:"save"}},{default:se(()=>[F("添加")]),_:1}),o("a",{href:"javascript:;",onClick:a[0]||(a[0]=m=>l("voice"))},"声音: "+v(d(w.value.voice)),1),o("a",{href:"javascript:;",onClick:a[1]||(a[1]=m=>l("syllables"))},"音节: "+v(d(w.value.syllables)),1),o("a",{href:"javascript:;",onClick:a[2]||(a[2]=m=>l("review"))},"默写: "+v(d(w.value.review)),1),o("a",{href:"javascript:;",onClick:a[3]||(a[3]=m=>l("view"))},"释义: "+v(d(w.value.view)),1)])}}});const we=G(_e,[["__scopeId","data-v-ee7d2762"]]),H=h=>(ie("data-v-44490f4f"),h=h(),ve(),h),ge={class:"coding"},ye={class:"container"},he={class:"write-wrap"},me={class:"write-box"},xe={key:0},ke=H(()=>o("div",{class:"cursor hide"},null,-1)),Ce={class:"row"},be=H(()=>o("div",{class:"cursor"},null,-1)),Ve={class:"write-box"},$e={key:0},Se={key:0,class:"voice"},Ie={key:0,class:"count"},Le=T({__name:"coding",setup(h){const c=ae(),w=fe(),d=M(),l=L([]),i=L(0),f=n(()=>d.config.syllables),a=n(()=>d.config.review),$=n(()=>d.config.voice),m=n(()=>d.config.view),p=L(""),J=n(()=>c.params.date||de(new Date,"YYYY-mm-dd"));n(()=>c.query.name||"");const g=n(()=>l.value[i.value]||{}),K=n(()=>l.value.length||0),R=n(()=>{const t=g.value.word||"";return f.value&&t?g.value.syllables||t||"":t||""}),x=n(()=>[...R.value]),S=n(()=>[...p.value]),k=n(()=>g.value.uk_pron||""),I=n(()=>(g.value.interpret||"").split(/\r?\n/)),W=L(null),A=n(()=>{const t=[];return x.value.forEach((e,s)=>{(S.value[s]||"").toLocaleLowerCase()===(e||"").toLocaleLowerCase()?t.push("success"):t.push("error")}),t}),Y=n(()=>{const t=A.value.filter(_=>_==="success").length,e=x.value.length,s=S.value.length;return t===e&&e===s}),j=t=>{const e=l.value.length;return!e||t>e-1?0:t<0?e-1:t},y=()=>{if(!$.value)return;const t=g.value.word;if(t){const e=`https://audio2.beingfine.cn/speeches/UK/UK-speech/${g.value.word}.mp3`;new Audio(e).play(),document.title=t+` - ${I.value[0]} - /${k.value}/`}else document.title="Words"},z=()=>{a.value||(console.log(`%c${R.value}`,"font-size:16px;font-weight:bold"),k.value&&console.log(`%c/${k.value}/`,"font-size:12px")),I.value[0]&&console.log(`%c${I.value[0]}`,"font-size:12px")},E=()=>{a.value&&y();const e=i.value+1;i.value=j(e),p.value="",z(),a.value||y()},P=()=>{a.value&&y();const e=i.value-1;i.value=j(e),p.value="",z(),a.value||y()},Q=()=>{O()},O=async()=>{var t;await ce(),(t=W.value)==null||t.focus()},C=t=>~t.indexOf("."),X=t=>{const{data:e}=t,s=A.value.lastIndexOf("success"),_=x.value[s+1];f.value&&_&&e&&C(_)&&(p.value=p.value+".")},N=async()=>{const t=await w.get();l.value=t.filter(e=>e.date===J.value),O()},Z=()=>{a.value&&y(),l.value=l.value.filter(s=>s.word!==g.value.word);const e=i.value+1;i.value=j(e),p.value="",z(),a.value||y()},ee=async t=>{const e=t.keyCode;if(e!==9){if(e===189||e===187||(e===13&&Y.value&&Z(),e===32&&Y.value&&E(),e===39&&E(),e===37&&P(),S.value.length>=x.value.length&&e!==8))return t.returnValue=!1,!1;if(e===8){p.value="";return}t.returnValue=e>=65&&e<=90}};return ne(()=>c.params.date,async()=>{await N()}),oe(async()=>{await N()}),U(async()=>{await N()}),(t,e)=>(r(),u("div",ge,[o("div",ye,[o("div",he,[o("div",me,[l.value.length?(r(),u("div",xe,[o("div",{class:b(["row",{review:a.value}])},[(r(!0),u(B,null,D(x.value,(s,_)=>(r(),u("div",{key:s+_,class:b([{dot:C(s)},"word"])},v(C(s)?"":s),3))),128)),ke],2),o("div",Ce,[(r(!0),u(B,null,D(S.value,(s,_)=>(r(),u("div",{key:s+_,class:b([{dot:C(s),[A.value[_]]:!0},"word"])},v(C(s)?"":s),3))),128)),be]),le(o("input",{ref_key:"inputRef",ref:W,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),type:"text",class:"input",onKeydown:ee,onBlur:Q,onInput:X},null,544),[[re,p.value]])])):V("",!0)]),o("div",Ve,[l.value.length?(r(),u("div",$e,[k.value?(r(),u("div",{key:0,class:b([{review:a.value},"ukpron"])},[F("/"+v(k.value)+"/ ",1),$.value?(r(),u("span",Se,"V")):V("",!0)],2)):V("",!0),o("div",{class:b(["interprets",{review:m.value}])},[(r(!0),u(B,null,D(I.value,s=>(r(),u("div",{key:s},v(s),1))),128))],2)])):V("",!0)]),K.value?(r(),u("div",Ie,v(i.value+1)+" / "+v(K.value),1)):V("",!0)])]),q(ue(we))]))}});const Ne=G(Le,[["__scopeId","data-v-44490f4f"]]);export{Ne as default};
